<div class="p-8">
    <div class="max-w-7xl mx-auto">
        <!-- Header -->
        <header class="mb-8">
            <h1 class="text-4xl font-bold text-secondary mb-2">Bem-vindo, {{ userName }}!</h1>
            <p class="text-gray-600">Explore e participe de eventos incríveis</p>
        </header>

        <!-- Minhas Inscrições -->
        <section class="mb-12">
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-2xl font-bold text-secondary flex items-center gap-2">
                    <i class="ph-bold ph-calendar-check text-3xl"></i>
                    Minhas Inscrições
                </h2>
                <div class="flex items-center gap-4">
                    <span class="text-sm text-gray-500">{{ myEvents.length }} evento(s)</span>
                    <button *ngIf="myEvents.length > 0" (click)="viewAllEnrollments()"
                        class="text-sm text-secondary hover:text-secondary/80 font-semibold flex items-center gap-1">
                        Ver todos
                        <i class="ph-bold ph-arrow-right"></i>
                    </button>
                </div>
            </div>

            <!-- Loading State -->
            <div *ngIf="isLoadingMy" class="bg-white rounded-2xl p-8 text-center shadow-sm">
                <div class="w-8 h-8 border-4 border-gray-200 border-t-secondary rounded-full animate-spin mx-auto mb-3">
                </div>
                <p class="text-gray-500">Carregando suas inscrições...</p>
            </div>

            <!-- Empty State -->
            <div *ngIf="!isLoadingMy && myEvents.length === 0" class="bg-white rounded-2xl p-8 text-center shadow-sm">
                <i class="ph-bold ph-calendar-x text-6xl text-gray-300 mb-4"></i>
                <p class="text-gray-500">Você ainda não está inscrito em nenhum evento.</p>
                <p class="text-gray-400 text-sm mt-2">Explore os eventos disponíveis abaixo!</p>
            </div>

            <!-- Events List -->
            <div *ngIf="!isLoadingMy && myEvents.length > 0"
                class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <article *ngFor="let event of myEvents"
                    class="bg-white rounded-2xl p-6 shadow-sm hover:shadow-md transition-shadow border-l-4 border-secondary"
                    [class.opacity-70]="isPastEvent(event)">
                    <div class="flex justify-between items-start mb-3">
                        <span class="text-xs font-semibold text-secondary bg-secondary/10 px-3 py-1 rounded-full">
                            {{ getEventTypeLabel(event.type) }}
                        </span>
                        <button *ngIf="!isPastEvent(event)" (click)="cancelEnrollment(event)"
                            class="text-red-500 hover:text-red-700 transition-colors" title="Cancelar inscrição">
                            <i class="ph-bold ph-sign-out text-xl"></i>
                        </button>
                        <span *ngIf="isPastEvent(event)"
                            class="text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded-full">
                            Realizado
                        </span>
                    </div>

                    <h3 class="text-xl font-bold text-secondary mb-2">{{ event.title }}</h3>
                    <p class="text-gray-600 text-sm mb-4 line-clamp-2">{{ event.description || 'Sem descrição' }}</p>

                    <div class="space-y-2 text-sm text-gray-500">
                        <div class="flex items-center gap-2">
                            <i class="ph-bold ph-calendar"></i>
                            <span>{{ formatDate(event.date) }}</span>
                        </div>
                        <div class="flex items-center gap-2">
                            <i class="ph-bold ph-clock"></i>
                            <span>{{ event.time }}</span>
                        </div>
                        <div class="flex items-center gap-2">
                            <i class="ph-bold ph-map-pin"></i>
                            <span>{{ event.location }}</span>
                        </div>
                    </div>

                    <button (click)="viewEventDetails(event.id)"
                        class="mt-4 w-full bg-secondary text-white py-2 rounded-lg hover:bg-secondary/90 transition-colors font-semibold">
                        Ver Detalhes
                    </button>
                </article>
            </div>
        </section>

        <!-- Eventos Disponíveis -->
        <section>
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-2xl font-bold text-secondary flex items-center gap-2">
                    <i class="ph-bold ph-calendar-plus text-3xl"></i>
                    Eventos Disponíveis
                </h2>
                <div class="flex items-center gap-4">
                    <span class="text-sm text-gray-500">{{ availableEvents.length }} evento(s)</span>
                    <button *ngIf="availableEvents.length > 0" (click)="viewAllAvailable()"
                        class="text-sm text-secondary hover:text-secondary/80 font-semibold flex items-center gap-1">
                        Ver todos
                        <i class="ph-bold ph-arrow-right"></i>
                    </button>
                </div>
            </div>

            <!-- Loading State -->
            <div *ngIf="isLoadingAvailable" class="bg-white rounded-2xl p-8 text-center shadow-sm">
                <div class="w-8 h-8 border-4 border-gray-200 border-t-primary rounded-full animate-spin mx-auto mb-3">
                </div>
                <p class="text-gray-500">Carregando eventos disponíveis...</p>
            </div>

            <!-- Empty State -->
            <div *ngIf="!isLoadingAvailable && availableEvents.length === 0"
                class="bg-white rounded-2xl p-8 text-center shadow-sm">
                <i class="ph-bold ph-calendar text-6xl text-gray-300 mb-4"></i>
                <p class="text-gray-500">Não há eventos disponíveis no momento.</p>
            </div>

            <!-- Events Grid -->
            <div *ngIf="!isLoadingAvailable && availableEvents.length > 0"
                class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <article *ngFor="let event of availableEvents"
                    class="bg-white rounded-2xl p-6 shadow-sm hover:shadow-md transition-shadow">
                    <div class="flex justify-between items-start mb-3">
                        <span class="text-xs font-semibold text-primary bg-primary/10 px-3 py-1 rounded-full">
                            {{ getEventTypeLabel(event.type) }}
                        </span>
                        <div class="text-xs text-gray-500">
                            <i class="ph-bold ph-users"></i>
                            {{ event.remaining_slots }} vagas
                        </div>
                    </div>

                    <h3 class="text-xl font-bold text-secondary mb-2">{{ event.title }}</h3>
                    <p class="text-gray-600 text-sm mb-4 line-clamp-2">{{ event.description || 'Sem descrição' }}</p>

                    <div class="space-y-2 text-sm text-gray-500 mb-4">
                        <div class="flex items-center gap-2">
                            <i class="ph-bold ph-calendar"></i>
                            <span>{{ formatDate(event.date) }}</span>
                        </div>
                        <div class="flex items-center gap-2">
                            <i class="ph-bold ph-clock"></i>
                            <span>{{ event.time }}</span>
                        </div>
                        <div class="flex items-center gap-2">
                            <i class="ph-bold ph-map-pin"></i>
                            <span>{{ event.location }}</span>
                        </div>
                    </div>

                    <!-- Barra de progresso de vagas -->
                    <div *ngIf="event.capacity && event.capacity > 0" class="mb-4">
                        <div class="h-2 bg-gray-200 rounded-full overflow-hidden">
                            <div class="h-full bg-secondary transition-all"
                                [style.width.%]="getCapacityPercentage(event)">
                            </div>
                        </div>
                        <p class="text-xs text-gray-500 mt-1">
                            {{ event.remaining_slots }} de {{ event.capacity }} vagas disponíveis
                        </p>
                    </div>
                    <div *ngIf="!event.capacity || event.capacity === 0" class="mb-4">
                        <div class="h-2 bg-gray-200 rounded-full overflow-hidden mb-1">
                            <div class="h-full bg-green-500 transition-all"
                                [style.width.%]="getCapacityPercentage(event)">
                            </div>
                        </div>
                        <p class="text-xs text-green-600 font-medium">
                            <i class="ph-bold ph-infinity"></i> Vagas ilimitadas
                        </p>
                    </div>

                    <button (click)="viewEventDetails(event.id)" [disabled]="event.remaining_slots === 0"
                        class="w-full bg-primary text-white py-2 rounded-lg hover:bg-primary/90 transition-colors font-semibold disabled:bg-gray-300 disabled:cursor-not-allowed">
                        <span *ngIf="event.remaining_slots > 0 || event.remaining_slots === null">Ver Detalhes e
                            Inscrever-se</span>
                        <span *ngIf="event.remaining_slots === 0">Esgotado</span>
                    </button>
                </article>
            </div>
        </section>
    </div>
</div>